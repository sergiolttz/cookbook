{% extends '__base.html' %}
{% block content %}
<h1>Lista de Recetas</h1>

<form method="get">
    <input type="text" name="q" placeholder="Buscar recetas..." value="{% if query %}{{ query }}{% endif %}">
    <button type="submit">Buscar</button>

    <label for="sort">Ordenar por:</label>
    <select name="sort" id="sort">
        <option value="">Ninguno</option>
        <option value="rating" {% if sort_by == 'rating' %}selected{% endif %}>Rating</option>
        <option value="duration" {% if sort_by == 'duration' %}selected{% endif %}>Duraci√≥n</option>
        <option value="ingredients" {% if sort_by == 'ingredients' %}selected{% endif %}>Ingredientes</option>
    </select>

    <label for="order">Orden:</label>
    <select name="order" id="order">
        <option value="asc" {% if order == 'asc' %}selected{% endif %}>Ascendente</option>
        <option value="desc" {% if order == 'desc' %}selected{% endif %}>Descendente</option>
    </select>

    <button type="submit">Filtrar/Ordenar</button>
</form>

<div class="recipe-list">
    {% for item in recipes_with_ratings %}
    <div class="recipe-card">
        <a href="{% url 'recipe-detail' pk=item.recipe.pk %}">
            <img src="{{ item.recipe.image.url }}" alt="{{ item.recipe.title }}">
            <h3>{{ item.recipe.title }}</h3>
            <p>Tiempo: {{ item.recipe.time_required }}</p>
            <p>Rating: {% if item.avg_rating %}{{ item.avg_rating|floatformat:1 }}{% else %}Sin calificar{% endif %}</p>
            <p>Ingredientes: {{ item.recipe.recipeingredient_set.count }}</p>
        </a>
    </div>
    {% empty %}
    <p>No se encontraron recetas.</p>
    {% endfor %}
</div>
{% endblock %}